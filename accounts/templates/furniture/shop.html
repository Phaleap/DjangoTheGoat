{% load static %}
<!DOCTYPE html>
<html lang="en">
  {% include 'furniture/Head.html' %}

  <body>
    {% include 'furniture/SecTop.html' %} {% include 'furniture/Header.html' %}

    <!-- Page Banner -->
    <section id="center" class="center_shop">
      <div class="promo_m center_om">
        <div class="container-fluid">
          <div class="center_o1 row text-center">
            <div class="col-md-12">
              <h6 class="col_yell fw-bold">
                <a class="text-white" href="#">HOME PAGE</a>
                <span class="mx-2 text-muted">/</span> SHOP
              </h6>
              <h1 class="mb-0 font_60 text-white mt-3">Shop</h1>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Shop Section -->
    <section id="shop" class="p_3 px-4">
      <div class="container-fluid">
        <div class="shop_1 row">
          <!-- Sidebar -->
          <div class="col-md-3">
            <div class="shop_1l">
              <!-- Categories -->
              <div class="shop_1l1">
                <h5>Categories</h5>
                <hr class="line mb-4" />
                <ul class="category-list mb-0 list-unstyled">
                  <li class="mb-2">
                    <a href="#" class="category-btn" data-filter="all"
                      >All Categories</a
                    >
                  </li>
                  {% for category in ObjDTCategory %}
                  <li class="mb-2">
                    <a
                      href="#"
                      class="category-btn"
                      data-filter="{{ category.id }}"
                    >
                      {{ category.categoryName }}
                      <span class="text-muted"
                        >({{ category.product_set.count }})</span
                      >
                    </a>
                  </li>
                  {% endfor %}
                </ul>
              </div>

              <!-- Filter by Price -->
              <div class="shop_1l1 mt-4">
                <h5>Filter By Price</h5>
                <hr class="line mb-4" />
                <h6 class="mb-0 font_14">
                  Price: $80 â€” $400
                  <a
                    class="bg_yell text-white p-2 ms-3 px-4 d-inline-block"
                    href="#"
                    >FILTER</a
                  >
                </h6>
              </div>

              <!-- Bestsellers -->
              <div class="shop_1l1 mt-4">
                <h5>Bestsellers</h5>
                <hr class="line mb-4" />
                {% for product in bestsellers %}
                <div class="row shop_1l1i mb-3">
                  <div class="col-4 pe-0">
                    <figure class="effect-jazz mb-0">
                      <a href="{% url 'detail' product.id %}">
                        <img
                          src="{{ product.productImage.url }}"
                          class="w-100"
                          alt="{{ product.productName }}"
                        />
                      </a>
                    </figure>
                  </div>
                  <div class="col-8">
                    <h6 class="fw-bold">
                      <a href="{% url 'detail' product.id %}"
                        >{{ product.productName }}</a
                      >
                    </h6>
                    <h5 class="mb-0 col_yell">
                      ${{ product.price|floatformat:2 }}
                    </h5>
                  </div>
                </div>
                {% empty %}
                <p>No bestsellers available.</p>
                {% endfor %}
              </div>
            </div>
          </div>

          <!-- Products -->
          <div class="col-md-9">
            <div class="shop_1r">
              <!-- Product Grid -->
              <div class="shop_1r1 mt-4 row">
                {% for product in Objproducts %}
                <div
                  class="col-md-4 mb-4 product-item"
                  data-category="{{ product.categoryID.id }}"
                >
                  <div class="shop_1r1l border_1">
                    <div class="shop_1r1l1 position-relative">
                      <figure class="effect-jazz mb-0">
                        <a href="{% url 'detail' product.id %}">
                          <img
                            src="{{ product.productImage.url }}"
                            class="w-100"
                            alt="{{ product.productName }}"
                          />
                        </a>
                      </figure>
                    </div>
                    <div class="shop_1r1l2 text-center p-4">
                      <h5 class="fw-bold mt-2">
                        <a href="{% url 'detail' product.id %}"
                          >{{ product.productName }}</a
                        >
                      </h5>
                      <h4 class="col_yell">
                        ${{ product.price|floatformat:2 }}
                      </h4>
                      <h6 class="mb-0 mt-3">
                        <a class="button_1" href="{% url 'detail' product.id %}"
                          >READ MORE
                          <i class="fa fa-long-arrow-right ms-1"></i>
                        </a>
                      </h6>
                    </div>
                  </div>
                </div>
                {% endfor %}
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    {% include 'furniture/Chatsec.html' %} {% include 'furniture/Footer.html' %}
    {% include 'furniture/script.html' %}

    <!-- JS Filter Script -->
    <script>
      document.querySelectorAll(".category-btn").forEach((btn) => {
        btn.addEventListener("click", function (e) {
          e.preventDefault();
          const filter = this.getAttribute("data-filter");
          const products = document.querySelectorAll(".product-item");

          products.forEach((item) => {
            if (
              filter === "all" ||
              item.getAttribute("data-category") === filter
            ) {
              item.style.display = "block";
            } else {
              item.style.display = "none";
            }
          });
        });
      });
    </script>
  </body>
</html>
